// Copyright (c) 2018 The Peacenet & Alkaline Thunder.

#pragma once

#include "CoreMinimal.h"
#include "Engine/DataAsset.h"
#include "Engine/Texture2D.h"
#include "CommandInfo.h"
#include "UVulnerability.generated.h"

/**
 * Represents a vulnerability/exploit in a computer service's implementation.
 */
UCLASS(Blueprintable, BlueprintType)
class PROJECTOGLOWIA_API UVulnerability : public UDataAsset
{
	GENERATED_BODY()

public:
	// The internal ID used for this Peacenet asset. This value is used for the generated Terminal Command for this exploit.
	UPROPERTY(BlueprintReadOnly, EditAnywhere, Category = "Metadata")
	FName InternalID;

	// The name of the exploit.
	UPROPERTY(BlueprintReadOnly, EditAnywhere, Category = "Metadata")
	FText Name;

	// The description of the exploit.
	UPROPERTY(BlueprintReadOnly, EditAnywhere, Category = "Metadata")
	FText Description;

	// The icon for the exploit.
	UPROPERTY(BlueprintReadOnly, EditAnywhere, Category = "Metadata")
	UTexture2D* Icon;

	// Is this item unlocked by the player by default?
	UPROPERTY(BlueprintReadOnly, EditAnywhere, Category = "Unlockable")
	bool UnlockedByDefault = false;

	// The minimum skill level the player must be to unlock this exploit, or the minimum skill level an NPC must be for this lootable to spawn in their filesystem. 0 = no limits.
	UPROPERTY(BlueprintReadOnly, EditAnywhere, Category = "Lootable")
	int MinimumSkillLevel = 0;

	// The maximum skill level an NPC can be before this lootable stops spawning in their filesystem. 0 = no limits.
	UPROPERTY(BlueprintReadOnly, EditAnywhere, Category = "Lootable")
	int MaximumSkillLevel = 0;

	// How rare is this item as a lootable?
	UPROPERTY(BlueprintReadOnly, EditAnywhere, Category = "Lootable")
	float Rarity = 0.f;

	// What services are vulnerable to this attack?
	UPROPERTY(BlueprintReadOnly, EditAnywhere, Category = "Vulnerability")
	TArray<UComputerService*> VulnerableAgainst;

	// If true, this vulnerability logs the hacking user in as an anonymous/fake user on the hacked system with virtually no privileges.
	UPROPERTY(BlueprintReadOnly, EditAnywhere, Category = "Vulnerability")
	bool UseAnonymousUser = false;
};

/**
 * A command info object that contains a reference to a vulnerability asset.
 */
UCLASS()
class PROJECTOGLOWIA_API UVulnerabilityCommandInfo : public UCommandInfo
{
	GENERATED_BODY()

public:
	UPROPERTY()
	UVulnerability* Vulnerability;
};